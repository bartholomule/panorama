
.SUFFIXES:
.SUFFIXES: .cpp .h .o .l .y

#
# You can modify this variables (at your own risk) if you want to change the normal
# directory structure
#

TOPDIR       = @prefix@
BIN_DIR      = ${TOPDIR}/bin/
INCLUDE_DIR  = ${TOPDIR}/include/
LIB_DIR      = ${TOPDIR}/lib/
DOC_DIR      = ${TOPDIR}/doc/
CONFIG_DIR   = ${TOPDIR}/etc/
PLUGIN_DIR   = ${LIB_DIR}/plugins/
TEXTURE_DIR  = ${LIB_DIR}/texture/
GRADIENT_DIR = ${LIB_DIR}/gradients/
SCENE_DIR    = ${TOPDIR}/scenes/

#
# Don't change anything below this line.
#

LLAPI_LIB = ${BUILD_TOP}/llapi/libllapi.so
HLAPI_LIB = ${BUILD_TOP}/hlapi/libhlapi.so

STATIC_LLAPI_LIB = ${BUILD_TOP}/llapi/libllapi.a
STATIC_HLAPI_LIB = ${BUILD_TOP}/hlapi/libhlapi.a

INCLUDE = -I${BUILD_TOP} -I${SRC_DIR}/${BUILD_TOP} -I${SRC_DIR} @extra_includes@
LDFLAGS += @extra_libs@
DEFS    = @DEFS@ \
          -DTOPDIR='"${TOPDIR}"' \
	  -DSTATIC_LINK=@STATIC_LINK@ 
          

CXX      = @CXX@
LEX      = @LEX@
YACC     = @YACC@
LEXFLAGS = -8 -t

ARCH_MAKE_SHARED_OPTS = @ARCH_MAKE_SHARED_OPTS@
ARCH_PROG_SETLIBPATH  = @ARCH_PROG_SETLIBPATH@

ifeq (@DEBUG_INFO@,1)
DBG = -ggdb
else
DBG = 
endif

ifeq (@OPTIMIZATIONS_ALLOWED@,1)
OPT = -O@OPTIMIZATION_LEVEL@  
#-fno-math-errno 
ifeq (@OPTIMIZE_EXPENSIVE@,1)
OPT += -fexpensive-optimizations
endif
else
OPT = 
endif

# Add in the target cpu type
OPT += @CPU_SPECIFIC_FLAG@


ifeq (@STATIC_LINK@,1)
LLAPI_LIB = ${STATIC_LLAPI_LIB}
HLAPI_LIB = ${STATIC_HLAPI_LIB}
STAT =
else
STAT =
endif

ifeq (@PROFILE@,1)
PROF = -pg
else
PROF = -fomit-frame-pointer
endif

ifeq (@EXCEPTIONS_ALLOWED@, 0)
EXCEPTION_FLAGS = -fno-exceptions
else
EXCEPTION_FLAGS = 
endif

ifneq (@RTTI_ALLOWED@, 1)
RTTI = -fno-rtti
else
RTTI = -DUSE_RTTI=1
endif

CXXFLAGS = ${OPT} ${DBG} ${STAT} ${PROF} -ansi ${EXCEPTION_FLAGS} ${RTTI} \
	   -Wall -Wstrict-prototypes ${DEFS} ${INCLUDE}

# The following one causes the gui to fail to build on my machine.  I don't know why.
# -pedantic
